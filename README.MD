# Show-GroupTree.ps1

Ein PowerShell-Skript zur **grafischen Darstellung von Active Directory-Gruppenmitgliedschaften** mit Unterst√ºtzung f√ºr:

- rekursive Gruppendarstellung
- Zykluserkennung (rot markiert)
- doppelte Benutzer (orange markiert)
- einfache Windows Forms-GUI (TreeView)

---

## üîß Voraussetzungen

- Windows PowerShell (mind. v5 empfohlen)
- ActiveDirectory-Modul (`RSAT: Active Directory Tools`)
- Keine zus√§tzliche Software notwendig

---

## üí° Funktionsweise

Das Skript l√§dt mithilfe von `System.Windows.Forms` ein interaktives Fenster, das die Mitgliederstruktur einer AD-Gruppe als **TreeView** darstellt.

- Gruppenmitglieder werden rekursiv durchlaufen.
- Benutzer mit mehrfacher Zugeh√∂rigkeit im Baum werden als `(Duplikat)` markiert und orange eingef√§rbt.
- Zyklische Gruppenzuordnungen (Gruppe A enth√§lt Gruppe B, die wieder Gruppe A enth√§lt) werden erkannt und **rot** dargestellt mit dem Hinweis `(Zyklus!)`.

---

## üì• Parameter

| Parameter     | Typ      | Beschreibung                                                                 |
|---------------|----------|------------------------------------------------------------------------------|
| `StartGroup`  | `string` | (Erforderlich) Name der AD-Gruppe, die als Wurzel des TreeViews genutzt wird |

---

## ‚ñ∂Ô∏è Beispiel

```powershell
Show-GroupTree -StartGroup "GruppeA"
```

## üé® Darstellungshinweise

Im TreeView werden Gruppen und Benutzer wie folgt dargestellt:

| Darstellung                       | Bedeutung                                 | Farbe       |
|----------------------------------|-------------------------------------------|-------------|
| `GruppeX`                        | Gruppenname                               | Standard    |
| `BenutzerX`                      | Benutzername (erste Anzeige)              | Standard    |
| `BenutzerX (Duplikat)`           | Benutzer kommt mehrfach in der Struktur vor | Orange      |
| `GruppeX (Zyklus!)`              | Zyklus erkannt (Gruppe enth√§lt sich selbst rekursiv) | Rot         |
| `(Fehler beim Abrufen)`          | Fehler beim Aufl√∂sen der Gruppenmitglieder | Grau/Standard |

Die Verschachtelung wird automatisch anhand der AD-Struktur erzeugt.
